# Graded Questions

**Note:** Give answers considering an unclean dataset.

#### Hive Querying

Qn: What is the total revenue generated by Tier-3 Android users?

- ~14,27,000

- ~10,17,000

- ~5,38,000

- ~16,23,000

Ans: B. *You need to perform an inner join as shown below to get the answer.*

```sql
select sum(revenue_usd) from device_stg d
inner join crm_stg t
on d.msisdn = t.msisdn
inner join revenue_stg r
on t.msisdn = r.msisdn
where value_segment   = 'Tier_3' and os_name = 'Android';
```

Qn: Which brand has generated the highest revenue among ‘active’ customers?

- Nokia

- Symphony

- Huawei

- Samsung

Ans: D. *You need to perform an inner join as shown below to get the answer.*

```sql
select brand_name, sum(revenue_usd) as total_revenue from crm_stg t
inner join device_stg d
on t.msisdn = d.msisdn
inner join revenue_stg r
on d.msisdn = r.msisdn
where system_status = 'ACTIVE'
group by brand_name
order by total_revenue desc
limit 1;
```

Qn: How many people falling in the age group of 30–40 years use prepaid phones? (Select the appropriate range from the options)

- 75,00,000-100,00,000

- 50,00,000-75,00,000

- 25,00,000-50,00,000

- 100,000-25,00,000

Ans: C. *This is the right option. You need to filter the data basis the mobile type and range of the person to find the answer.*

```sql
select count(distinct msisdn) from crm_stg
where mobile_type = 'Prepaid' and (Year(Current_Date()) - year_of_birth) between 30 and 40;
```

Qn: Which location has the highest count of Nokia customers? Note - If you are confused on the column that represents location, you can check the data description sheet provided in the case study.

- 735ce0191653ca26bf22fbd357f5b726

- E7074979589f925135b1ca2e47fae882

- Fe1adffea04aabd9ba72a321e05c25be

- ae7c92cccc6b4f96434aa5f3c274ae46

Ans: A.

```sql
select brand_name, imei_tac, count(distinct msisdn) as num_of_customers from device_stg
group by brand_name, imei_tac
having brand_name = 'NOKIA'
order by num_of_customers desc
limit 1;
```

Qn: How many brands are present in the devices table? (Null values to be ignored)

- 1,325

- 1,333

- 1,321

- 1,330

Ans: C.

```sql
select count(distinct brand_name) from device_stg;
```

Qn: Select the option that best describes the output of this query:

```sql
create view weekly_brand_revenue as
(select week_number, brand_name, sum(revenue_usd) as weekly_revenue from revenue_stg r
inner join device_stg d
on r.msisdn = d.msisdn
group by week_number, brand_name
order by week_number, weekly_revenue desc);

select w.week_number, w.brand_name, w.weekly_revenue from
(select week_number, max(weekly_revenue) as max_brand_revenue from weekly_brand_revenue group by week_number) 
as x 
inner join weekly_brand_revenue as w 
on x.week_number = w.week_number and x.max_brand_revenue = w.weekly_revenue;
```

- It returns the week_number, the brand that generated the maximum revenue and the revenue generated by all the brands that week.

- It returns the week_number, the brand that generated the maximum revenue and the revenue generated by all the brands in the preceding week.

- It returns the week_number, the brand that generated the maximum revenue and the revenue generated by that brand in that week.

- It returns the week_number, the brand that was used by maximum customers and the total revenue generated in that week.

Ans: C. *Usually, it is difficult to extract the entire row after performing a grouping function. Hence, we have used a self join that matches the maximum value of each group and the week_number to attach the brand name that has generated the maximum revenue in that week.*
